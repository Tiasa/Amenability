Read(Filename(DirectoryHome(),"confluent_rewriting_systems/config.g"));
inc_mats:=[[[1,1,1,0,0,0],[1,0,0,1,1,0],[0,1,0,1,0,1],[0,0,1,0,1,1]],[[1,1,1,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,1,1,1],[1,0,0,1,0,0,1,0,0],[0,1,0,0,1,0,0,1,0],[0,0,1,0,0,1,0,0,1]],[[1,1,1,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,1,1,0],[0,1,0,1,0,0,0,0,1],[0,0,1,0,1,0,1,0,0],[0,0,0,0,0,1,0,1,1]],[[1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1],[1,0,0,1,0,0,1,0,0,0,0,0],[0,1,0,0,1,0,0,0,0,1,0,0],[0,0,1,0,0,0,0,1,0,0,1,0],[0,0,0,0,0,1,0,0,1,0,0,1]],[[1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,1,1,0],[0,1,0,1,0,0,0,0,0,0,0,1],[0,0,1,0,1,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,1,0,1,0,0],[0,0,0,0,0,0,0,0,1,0,1,1]],[[1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,1,1,0],[0,0,0,1,0,0,1,0,0,0,0,1],[0,1,0,0,1,0,0,0,0,0,0,1],[0,0,0,0,0,1,0,1,0,1,0,0],[0,0,1,0,0,0,0,0,1,0,1,0]],[[1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,1,1,0],[0,0,0,1,0,0,1,0,0,0,0,1],[0,0,0,0,1,0,0,1,0,0,0,1],[0,1,0,0,0,1,0,0,0,1,0,0],[0,0,1,0,0,0,0,0,1,0,1,0]],[[1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,1,1,0],[0,0,0,1,0,0,1,0,0,0,0,1],[0,1,0,0,0,0,0,0,0,1,0,1],[0,0,1,0,1,0,0,1,0,0,0,0],[0,0,0,0,0,1,0,0,1,0,1,0]],[[1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0],[1,0,0,0,0,0,1,1,0,0,0,0],[0,0,0,1,0,0,0,0,1,1,0,0],[0,1,0,0,0,0,1,0,0,0,1,0],[0,0,0,0,1,0,0,0,1,0,0,1],[0,0,1,0,0,0,0,1,0,0,1,0],[0,0,0,0,0,1,0,0,0,1,0,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,0,0,1,0,0,1,0,0,0,0,0,0,0,0],[0,1,0,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,1,0,0,1,0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,1,0,0,1,0,0,1,0],[0,0,0,0,0,0,0,0,1,0,0,1,0,0,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,0,0,1,0,0,1,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,1,0,0,1,0,0],[0,0,1,0,1,0,0,0,0,0,1,0,0,0,0],[0,0,0,0,0,1,0,1,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,1,0,0,1,0,0,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,0,1,0,0,0,0,0,0,0,0,0,0,1],[0,0,1,0,1,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,1,0,1,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,1,0,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,1,0,1,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,0,1,0,0,0,0,0,0,0,0,0,0,1],[0,0,1,0,1,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,1,0,0,1,0,0,1,0,0],[0,0,0,0,0,0,0,1,0,0,1,0,0,1,0],[0,0,0,0,0,1,0,0,1,0,0,1,0,0,0]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,1],[0,0,0,0,1,0,0,1,0,1,0,0,0,0,0],[0,1,0,0,0,1,0,0,1,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0,0,1,0,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,1,0,1,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,1],[0,1,0,0,0,0,0,0,0,1,0,0,1,0,0],[0,0,1,0,1,0,0,0,0,0,1,0,0,0,0],[0,0,0,0,0,1,0,1,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,0,0,1,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,1],[0,1,0,0,0,0,0,0,0,1,0,0,1,0,0],[0,0,1,0,0,0,0,0,0,0,1,0,0,1,0],[0,0,0,0,1,0,0,1,0,0,0,1,0,0,0],[0,0,0,0,0,1,0,0,1,0,0,0,0,0,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,1],[0,0,0,0,1,0,0,1,0,0,0,0,0,0,1],[0,1,0,0,0,1,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,1,0,1,0,0],[0,0,1,0,0,0,0,0,0,0,0,1,0,1,0]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,1],[0,1,0,0,0,0,0,0,0,1,0,0,0,0,1],[0,0,1,0,1,0,0,0,0,0,1,0,0,0,0],[0,0,0,0,0,1,0,1,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0,1,0,0,1,0,1,0]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,1],[0,1,0,0,0,0,0,0,0,1,0,0,0,0,1],[0,0,1,0,1,0,0,0,0,0,0,0,1,0,0],[0,0,0,0,0,1,0,1,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,1,0,1,0]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,1],[0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],[0,1,0,0,0,1,0,0,0,0,0,0,1,0,0],[0,0,1,0,0,0,0,1,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,1,0,1,0]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,1],[0,1,0,0,0,0,0,0,0,0,0,0,1,0,1],[0,0,1,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,1,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,1,0,1,0]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,1,0,1],[0,0,1,0,0,0,0,0,0,0,0,0,0,1,1],[0,0,0,1,0,0,1,0,0,1,0,0,0,0,0],[0,0,0,0,1,0,0,1,0,0,1,0,0,0,0],[0,0,0,0,0,1,0,0,1,0,0,1,0,0,0]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,1,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,0,1,1],[0,1,0,0,1,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,1,0,0,1,1,0,0,0,0,0],[0,0,1,0,0,0,0,0,0,0,0,1,0,1,0],[0,0,0,0,0,0,0,0,0,0,1,0,1,0,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,1,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,0,1,1],[0,1,0,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,1,0,0,1,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,1,0,1,0],[0,0,0,0,0,0,0,0,0,0,1,0,1,0,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,1,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,0,1,1],[0,1,0,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,1,0,0,0,0,1,0,0,0,1,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,0,0,1,0,1,0,0,0,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,1,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,0,1,1],[0,1,0,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,1,0,0,0,0,1,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,1,1,0],[0,0,0,0,0,1,0,0,1,0,0,0,0,0,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,1,0,0],[0,1,0,0,0,0,0,0,0,1,0,0,0,1,0],[0,0,0,0,1,0,1,0,0,0,0,0,0,0,1],[0,0,1,0,0,0,0,1,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,1,0,1,0],[0,0,0,0,0,1,0,0,0,0,0,0,1,0,1]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,1,0,0],[0,1,0,0,0,0,0,0,0,1,0,0,0,1,0],[0,0,0,0,1,0,1,0,0,0,0,0,0,0,1],[0,0,1,0,0,0,0,1,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,1,0,0,1],[0,0,0,0,0,1,0,0,0,0,0,0,1,1,0]],[[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,1,1,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,1,0,0],[0,1,0,0,0,0,0,0,0,1,0,0,0,1,0],[0,0,0,0,1,0,1,0,0,0,0,0,0,0,1],[0,0,1,0,0,0,0,0,0,0,1,0,0,1,0],[0,0,0,0,0,1,0,1,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,0,1,0,1]]];


orderings_10_vert:=[[13,14,10,4,8,6,3,12,7,15,9,5,1,16,11,2],[12,1,13,3,15,9,8,4,7,16,10,2,11,6,5,14],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[12,11,7,16,5,9,2,1,15,10,4,6,3,13,14,8],[2,10,4,5,7,9,15,14,16,3,1,13,6,12,8,11],[8,10,6,12,3,2,16,14,1,15,5,11,4,9,7,13],[14,12,15,6,2,1,7,10,13,4,5,11,3,9,8,16],[8,3,2,4,6,5,9,7,13,15,10,1,14,11,12,16],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[5,12,16,4,8,14,1,9,10,3,2,15,6,11,13,7],[12,5,8,14,11,4,6,9,1,10,16,15,7,2,3,13],[5,2,14,8,9,11,13,15,6,7,16,12,3,4,10,1],[9,15,5,3,1,16,8,2,12,11,10,7,4,6,13,14],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]];

sizes:=[];
problems:=[];
for i in [1..Length(inc_mats)] do
    Display(i);
    R:=calculate_rewriting_system(inc_mats[i],[0,0,0,0,0,0,0,0,0,0]);

		# special case, use custom ordering
		if i=7 then
			SetOrderingOfKBMAGRewritingSystem(R,"wreathprod",[ 4, 6, 3, 13, 11, 2, 12, 7, 5, 8, 1, 10, 9 ]);
		elif i>9 then
			SetOrderingOfKBMAGRewritingSystem(R,"wreathprod",orderings_10_vert[i-9]);
		else
   		SetOrderingRWS(R,"recursive");
		fi;

    O := OptionsRecordOfKBMAGRewritingSystem( R );
    O.maxeqns:=300; 
    MakeConfluent(R);

    if IsConfluent(R) then
        # Display size of the RWS
        Append(sizes,[Size(Rules(R))]);
    else
        Append(problems,[i]);
    fi;
od;
